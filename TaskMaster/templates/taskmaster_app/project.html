{% extends 'base.html' %}
{% load static %}
{% block body %}

<div class="jumbotron">
    <h2 align="center">{{project}}</h2>
</div>

<div class="row" style="padding-bottom:5px">
    <div class="col-xs-12">
        <div align="right"><a href="{% url 'taskmaster_app:add_project' %}?id={{project.id}}"><button class="btn btn-sm btn-primary">Edit Project</button></a></div>
    </div>
</div>
<div class="row" style="padding-bottom:40px">
    <div class="container-fluid" style="padding:0px">
        <div class="col-xs-12"><h4 class="page-header">Description</h4></div>
        <div class="col-xs-12">{{project.description}}</div>
    </div>
</div>
<!--Panel of current tasks with link to create new one-->
<!--<div class="col-xs-12" style="padding-left:0px; padding-right=0px">
    
    <div class="col-xs-12" style="padding-bottom:5px; padding-left:0px; padding-right:0px">
        <h3 class="page-header">
        <div class="col-xs-11">Tasks</div>
        <div class="col-xs-1" align="center"><a href="{% url 'taskmaster_app:add_task' project=project.slug %}">+</a></div>
        </h3>
    </div>
    <div class="col-xs-12">
    {% if tasks %}
        {% for task in tasks %}
            <h4 class="section-header"><a href="{% url 'taskmaster_app:task_view' project=project.slug task=task.slug %}?id={{task.id}}">{{task.title}}</a></h4>
            {{task.task_instructions|linebreaks}}
                {% if task.resources.all %}Resources: {% endif %}
                {% for resource in task.resources.all %}
                    {{resource}}{% if not forloop.last %} | {% endif %}
                {% endfor %}
        {% endfor %}
    {% else %}
        <div class="alert alert-warning" align="center">
            <h4>This Project doesn't have any Tasks associated with it yet.</h4>
        </div>
    {% endif %}
    </div>
</div>-->
<div class="row">
    <div class="panel panel-default">
        <!--Task Panel Heading-->
        <div class="panel-heading">
            <div class="container-fluid" style="padding:0px">
                <div class="col-xs-11" style="padding:0px"><h4 class="panel-title">Tasks</h4></div>
                <div class="col-xs-1" style="padding:0px"><a href="{% url 'taskmaster_app:add_task' project=project.slug %}"><h4 class="panel-title" align="right"><button class="btn btn-xs btn-primary" align="right">+</button></h4></a></div>
            <!--<h3 class="panel-title">
                <div class="pull-left"><h3 class="panel-title">Task</h3></div>
                <div class="pull-right"><h3 class="panel-title"><a href="{% url 'taskmaster_app:add_task' project=project.slug %}" class="btn btn-sm btn-default btn-block"><span class="glyphicon glyphicon-plus text-primary"></span></a></h3></div>
            </h3>-->
            </div>
        </div>
        <!--If there are existing tasks, display in a table; else, display alert-->
        {% if tasks %}
        <table class="table">
            <tr>
                <th>Title</th>
                <th>Status</th>
                <th>Complexity</th>
                <th>Est. Hours</th>
                <th>Deadline</th>
                <th>Resources</th>
            </tr>
            {% for task in tasks %}
            <tr>
                <td><a href="{% url 'taskmaster_app:task_view' project=project.slug task=task.slug %}?id={{task.id}}">{{task.title}}</a></td>
                <td>{{task.status}}</td>
                <td>{{task.complexity}}</td>
                <td>{{task.estimated_time}}</td>
                <td>{{task.deadline}}</td>
                <td>
                    {% for resource in task.resources.all %}
                        {{resource}}{% if not forloop.last %} | {% endif %}
                    {% endfor %}
                </td>
            </tr>
            {% endfor %}
        </table>
        {% else %}
        <div class="panel-body">
            <div class="alert alert-warning" align="center">
                <h5>This Project doesn't have any Tasks associated with it.</h5>
            </div>
        </div>
        {% endif %}
    </div>   
</div>
<div class="row">
    <div class="panel panel-default">
        <!--Attachment Panel Heading-->
        <div class="panel-heading">
            <h4 class="panel-title">Attachments</h4>
        </div>
        <!--If there are existing attachments, display in a table; else, display alert-->
        {% if files %}
        <table class="table">
            <tr>
                <th></th>
                <th>File Name</th>
                <th>Document Type</th>
                <th>Last Saved</th>
            </tr>
            {% for file in files %}
            <tr>
                <td></td>
                <td>{{file.f}</td>
                <td></td>
                <td></td>            
            </tr>
            {% endfor %}
        </table>
        {% else %}
        <div class="panel-body">
            <div class="alert alert-warning" align="center">
                <h5>This Project doesn't have any Attachments associated with it.</h5>
            </div>
        </div>
        {% endif %}
    </div>   
</div>
<div class="row" style="padding-top:10px">
    <div class="col-xs-12">
        <h4 class="page-header">Assigned Resources</h4>
        {% if resources %}
            {% for resource in resources %}
                <h5 class="section-header"><a href="{% url 'taskmaster_app:resource_view' resource=resource.slug %}?id={{resource.id}}">{{resource.user.first_name}} {{resource.user.last_name}}</a></h5>
            {% endfor %}
        {% else %}
            <div class="alert alert-warning" align="center">
                <h4>This Project doesn't have any Resources assigned to it yet.</h4>
            </div>
        {% endif %}
    </div>
</div>
{% endblock body %}